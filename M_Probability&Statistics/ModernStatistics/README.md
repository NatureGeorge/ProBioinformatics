# Basic Concepts of Modern Statistics🐱‍🏍

```txt
Created Date: Sunday, December 29th 2019, 4:00:12 pm
Author: ZeFeng Zhu
```

## Basic Statistical Test

### Key🎯

* 统计与变异性
  * 根本上，统计学处理变异性及变异性不同的原因
  * 对于生物学中许多来源的变异性定量化是很重要的
    * 包括实验的不精确
    * 同一物种不同生物个体间的差异
    * 环境中的差异
* 检验的统计学意义
  * 统计学显著性检验的目的是辨别具有真正(生物学 etc.)意义的随机变化所导致的影响
* t-检验与替换
  * t-检验的目的是检验正态分布数据的平均值之间差异的显著性
  * Wilcoxon Test/Mann-Whitney Test for non-norm dist etc.
* 方差分析
  * 实验中有两组以上数据时，量化组平均值差异的显著性
* 卡方检验(Chi-square test)与Fisher精确检验(Fisher's exact test)
  * 经常用于用关联表表示的离散“计数”型数据
  * 目的是评价：如果零假设是真的，期望的计数之间的统计学意义，以及每个类别中的实际观察计数
* 基于再取样的检验
  * 为了计算p值，假定零假设是真的，替换大多数的统计检验，并且通常包含数据的随机化取样
* 多重检验
  * 当进行一次以上的统计检验时，有必要对多个采样进行校正，能给出一个不正确的小p值
  * Bonferroni校正
  * Benjamini-Hochberg校正

### 统计与变异性

* 描述性统计
* 算术平均值
* 中位数
* 标准差
* 异常值
* 四分位数

### 检验的统计学意义

__A frequently asked question:__ 大量的变异性是否归因于一个特定的因素?

__For instance:__

* 糖尿病患者与无该病的患者相比是否血糖水平有所不同? $\Leftrightarrow$ 两组患者之间测量的血糖变异性是否明显区别于其他因素的变异性?

__How to solve:__

* 利用统计显著性检验来区分随机发生的变异性(, 来看是否数据能够给出血糖水平差异的确实证据)
* 统计显著性检验基于零假设，即“观察到的效应是由于随机发生”的假设
* 进一步计算零假设为真的概率，称该概率为p-value
  * 如果p-value足够小，那么零假设就不成立，效应就不是随机发生
  * 若零假设的p-value小于0.05(95%显著性水平)或更小，小于0.01(99%显著性水平)，这种情况常**被**认为效应是显著的
  * 表明显著性水平的p-value是由试验者来设定的，p-value越小，假阳性(随机效应被归于真)概率越小，但假阴性(真效应被归于随机)概率会增加

### t-检验与替换

* t-test基本假设是数据符合正态分布
* t-test (Student's t-test)是对样本均值进行的显著性检验
* 单因素t-test: 检验一个样本的均值与一些确定值是否存在显著性差异
  * e.g 检验溶液的蛋白质浓度，可以用标准的已知浓度作为参考物, 单因素t-test被用于检验用相同检测方法重复的测量是否与已知浓度存在差异
* 双因素t-test: 两个样本的均值与其他每一个值之间是否存在显著性差异
* Paired t-test: 
  * e.g 5个志愿者餐前餐后测量的血糖水平数据可分为2组，数据不是相互独立的；同一人的数据是配对的；paired t-test就是把5个人的10个数据转化为5个餐前与餐后的血糖水平之差，然后用单因素t-test，看该差值的均值是否与0存在显著性差异
* 当数据不是正态分布时，可使用Wilcoxon检验，进行非参数检验

__Some details about the answer of the mentioned question:__

1. 检验数据是否符合正态分布
2. 如若不是则尝试剔除异常值再检验是否符合正态分布，若符合则进行下一步
3. 双因素t-test
4. 采用标准差作为变异度，且得到p-value
5. 进行判断

### 方差分析

* 与t-test一样也检验数据组均值之间是否存在统计显著性差异，但是其可以用于超过2组的数据检验
* 以方差为测量变异度的指标
* Summary:
  * 首先把所有数据混起来作为一组数据，计算总体均值与总体方差
  * 总体方差分解为两部分：
    * 组内方差 (每组数据各自的方差)
    * 组间方差 (不同组均值间的方差)
  * 如果组间方差比组内方差更高，那么表示效应更显著；反之随机因素更显著
  * 零假设：所有组的数据均满足相同均值的正态分布
  * 也有表示零假设概率的p-value

__Sample problem:__ 研究10种药物对血糖的影响，每一组有20人服用同一种药物(包括对照组)，(更复杂的分组：20人一组中男女各10名的子组等)

__How to solve:__

1. 方差分析，看组内方差与组间方差的大小关系😀
2. t-test两两比较45次，多重检验校正p-value😨

### Chi-square test & Fisher's exact test

__The reason to perform Chi-square test:__ 一些变量例如血糖水平是连续变化的，原则上可以取任意值；但**分类变量**只能取一系列离散值。分类变量可以用于定义t-test和方差分析组，但有时需要当作因变量，并对它们的值进行统计显著性检验，常用的方法就是Chi-square($\chi^{2}$) test。

__Sample Problem:__ 

* 表中数据是一种植物的3个变异体遭受的旱灾应激
* 实验观察到的基因数目符合正态分布
* 问题：变异体是否对应激有不同的反应
* 零假设：这些变异体对应激没有不同的反应
* 斜体数字给出每个种类期望的基因数，期望值建立在零假设为真的基础上 (e.g $43.8 = \frac{130}{178}*55$)

|   |变异体A|变异体B|变异体C|总合|
|---|---|---|---|---|
|相关上调基因应激数|55 (*43.8*)|30 (*46.0*)|45 (*40.2*)|130|
|无变化表达数|5 (*16.2*)|33 (*17.0*)|10 (*14.8*)|48|
|总合|60|63|55|178|

* 统计检验关注的就是观察计数(O)与期望计数(E)相互之间是否存在显著性差异
* step:
  * 先计算6格总合的$\chi^{2}$统计量$(O-E)^{2}/E$
    * 这个总合越大说明零假设为真的概率越大
  * p-value由$\chi^{2}$统计量的概率分布函数得到
* 若2*2分类表的数据小于等于5，则不能用卡方检验，可以用费歇尔精确检验提替代



## Reference📚

1. BIOINFORMATICS (2nd Edition) _T.Charlie Hodgman, Andrew French, David R.Westhead..._
